<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<!-- Contenu principal -->
<div class="bg-surface-0 dark:bg-surface-900">
  <div class="landing-wrapper overflow-hidden">
    <!-- Topbar unique -->
    <topbar-widget
    class="py-6 px-6 mx-0 md:mx-12 lg:mx-20 lg:px-20 flex items-center justify-between relative lg:static"
    (createOffer)="createDialog.open()">
  </topbar-widget>

    <!-- Hero (pas de menu ici) -->
    <app-accueil></app-accueil>

     <!-- ===================== SECTION : OFFRES EN VEDETTE ===================== -->
    <section id="offres-vedettes" class="section-container">
      <div class="section-header">
        <h2 class="section-title">‚≠ê Offres en vedette</h2>
        <p class="section-subtitle">D√©couvrez les opportunit√©s premium s√©lectionn√©es sp√©cialement pour vous</p>
      </div>

      <div class="cards-grid featured-grid">
        <div *ngFor="let job of featuredJobs" class="featured-card">
          <!-- Ruban vedette diagonal -->
          <div class="card-ribbon">
            <span>‚òÖ Vedette</span>
          </div>
          
          <div class="card-header">
            <div class="job-info">
              <div class="job-title">{{ job.titre }}</div>
              <div class="job-meta">
                {{ job.entreprise }} ‚Ä¢ {{ job.ville }}
              </div>
            </div>
          </div>

          <!-- Badge s√©par√© pour √©viter le conflit avec le ruban -->
          <div class="badges-container-vedette">
            <span class="type-badge"
                 [ngClass]="{
                  'cdi': job.type.toLowerCase() === 'cdi',
                  'cdd': job.type.toLowerCase() === 'cdd', 
                  'freelance': job.type.toLowerCase() === 'freelance',
                  'stage': job.type.toLowerCase() === 'stage'
                }">{{ job.type }}</span>
          </div>

          <p class="job-description">{{ job.resume }}</p>

          <div class="card-footer">
            <small class="publish-date">{{ job.publie_le | date:'mediumDate' }}</small>
            <button pButton pRipple label="Voir plus" class="view-btn" [rounded]="true" (click)="openOffreDetails(job.id)"></button>
          </div>
        </div>
      </div>
    </section>

    <div class="section-divider"></div>

    <!-- ===================== SECTION : NOS PARTENAIRES ===================== -->
    <section id="pubs" class="section-container">
      <div class="section-header">
        <h2 class="section-title">ü§ù Nos partenaires</h2>
        <p class="section-subtitle">Ils nous font confiance pour leur recrutement et d√©veloppement</p>
      </div>

      <div class="carousel-container">
        <p-carousel
          [value]="adsRow"
          [circular]="true"
          [autoplayInterval]="3000"
          [numVisible]="4"
          [numScroll]="1"
          [showNavigators]="true"
          [showIndicators]="false"
          [responsiveOptions]="[
            { breakpoint: '1200px', numVisible: 3, numScroll: 1 },
            { breakpoint: '992px',  numVisible: 3, numScroll: 1 },
            { breakpoint: '768px',  numVisible: 2, numScroll: 1 },
            { breakpoint: '560px',  numVisible: 1, numScroll: 1 }
          ]"
        >
          <ng-template pTemplate="item" let-ad>
            <div class="partner-card">
              <div class="partner-media">
                <img *ngIf="ad.image && !ad.video" [src]="ad.image" alt="partenaire" />
                <video *ngIf="ad.video" [src]="ad.video" muted autoplay loop playsinline></video>
              </div>
              <div class="partner-content">
                <div class="partner-title">{{ ad.titre }}</div>
                <p class="partner-description" [innerHTML]="ad.description || ''"></p>
                <a *ngIf="ad.lien" [href]="ad.lien" target="_blank" class="partner-link">
                  D√©couvrir ‚Üí
                </a>
              </div>
            </div>
          </ng-template>
        </p-carousel>
      </div>
    </section>

    <div class="section-divider"></div>

    <!-- ===================== SECTION : DERNI√àRES OFFRES ===================== -->
    <section id="offres-recents" class="section-container">
      <div class="section-header">
        <h2 class="section-title">üî• Derni√®res offres</h2>
        <p class="section-subtitle">Les opportunit√©s fra√Æchement publi√©es qui n'attendent que vous</p>
        <button pButton pRipple [text]="true" [rounded]="true" label="Voir toutes les offres ‚Üí" class="see-all-btn" (click)="goAllJobs()"></button>
      </div>

      <div class="cards-grid recent-grid">
        <div *ngFor="let o of recentOffers | slice:0:4" class="job-card">
          <div class="card-header">
            <div class="job-info">
              <div class="job-title" [title]="o.titre">{{ o.titre }}</div>
              <div class="job-meta">
                {{ o.entreprise }} ‚Ä¢ {{ o.ville }}
              </div>
            </div>
            <span class="type-badge">{{ o.type }}</span>
          </div>

          <p class="job-description">{{ o.resume }}</p>

          <div class="card-footer">
            <small class="publish-date">{{ o.publie_le | date:'mediumDate' }}</small>
            <button pButton pRipple label="Voir plus" class="view-btn" [rounded]="true" (click)="openOffreDetails(o.id)"></button>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<div class="section-divider"></div>

<!-- ===================== SECTION : CONSEILS CARRI√àRE ===================== -->
<section id="conseils" class="section-container">
  <div class="section-header">
    <h2 class="section-title">üí° Conseils carri√®re</h2>
    <p class="section-subtitle">Boostez votre parcours professionnel avec nos experts</p>
    <button pButton pRipple [text]="true" [rounded]="true" label="Voir tous les conseils ‚Üí" class="see-all-btn" (click)="goAllConseils()"></button>
  </div>

  <div class="cards-grid tips-grid">
    <div *ngFor="let t of tipsRow | slice:0:3" class="tip-card">
      <div class="tip-header">
        <h3 class="tip-title" [title]="t.titre">{{ t.titre }}</h3>
        <p-tag *ngIf="t.niveau" [value]="t.niveau" severity="secondary" styleClass="tip-level"></p-tag>
      </div>

      <p class="tip-excerpt">{{ t.extrait }}</p>

      <div class="tip-footer">
        <div class="tip-meta">
          <p-tag *ngIf="t.categorie" [value]="t.categorie" styleClass="tip-category" severity="success"></p-tag>
          <span *ngIf="t.publie_le" class="tip-date">{{ t.publie_le | date:'mediumDate' }}</span>
        </div>
        <button pButton pRipple label="Lire" class="read-btn" [rounded]="true" (click)="openConseilDialog(t)"></button>
      </div>
    </div>
  </div>
</section>

<!-- ... Le reste des dialogs reste identique ... -->
<p-dialog
  [(visible)]="detailsVisible"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [dismissableMask]="true"
  [style]="{ width: '900px', maxWidth: '95vw' }"
  [contentStyle]="{ 'max-height': '78vh', 'overflow-y': 'auto', 'overflow-x': 'hidden' }"
  [breakpoints]="{ '1200px': '900px', '960px': '95vw', '640px': '100vw' }"
  styleClass="modern-dialog"
  [header]="selectedOffre?.titre || 'D√©tail de l\'offre'">

  <ng-container *ngIf="selectedOffre as d">
    <div class="offer-details-container">
      <!-- En-t√™te avec infos principales -->
      <div class="offer-header-section">
        <div class="offer-company-info">
          <i class="pi pi-building text-2xl text-blue-600"></i>
          <div class="ml-3">
            <div class="text-lg font-semibold text-gray-800">
              {{ d.entreprise?.nom_entreprise || 'Entreprise' }}
            </div>
            <div class="text-sm text-gray-500 flex items-center gap-2">
              <i class="pi pi-map-marker"></i>
              {{ d.localisation || '‚Äî' }}
            </div>
          </div>
        </div>
      </div>

      <!-- Tags et badges -->
      <div class="offer-tags-section">
        <p-tag *ngIf="d.type_contrat" [value]="d.type_contrat" severity="info" styleClass="tag-modern"></p-tag>
        <p-tag *ngIf="$any(d.categorie)?.nom || d.categorie" 
               [value]="$any(d.categorie)?.nom ?? (typeof d.categorie === 'string' ? d.categorie : '')" 
               severity="success" 
               styleClass="tag-modern"></p-tag>
        <p-tag *ngIf="d.experience" [value]="'Exp√©rience: ' + d.experience" severity="warning" styleClass="tag-modern"></p-tag>
        <p-tag *ngIf="d.salaire" [value]="d.salaire + ' CFA'" severity="danger" styleClass="tag-modern"></p-tag>
      </div>

      <!-- Divider -->
      <div class="dialog-divider"></div>

      <!-- Description de l'offre -->
      <div class="offer-description-section">
        <h3 class="section-subtitle-dialog">
          <i class="pi pi-info-circle"></i>
          Description du poste
        </h3>
        <div class="offer-html-content" lang="fr" [innerHTML]="d.description || ''"></div>
      </div>

      <!-- Footer avec action -->
      <div class="offer-footer-section">
        <button 
          pButton 
          pRipple 
          label="Postuler maintenant" 
          icon="pi pi-send" 
          class="apply-button-modern"
          (click)="postuler(d)">
        </button>
        <button 
          pButton 
          pRipple 
          label="Fermer" 
          icon="pi pi-times" 
          class="p-button-text p-button-secondary"
          (click)="detailsVisible=false">
        </button>
      </div>
    </div>
  </ng-container>
</p-dialog>


<!-- ======== POSTULER (invit√© + connect√©) ======== -->
<p-dialog
  [(visible)]="applyVisible"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [dismissableMask]="true"
  [style]="{ width: '800px', maxWidth: '95vw' }"
  [breakpoints]="{ '960px': '95vw', '640px': '100vw' }"
  styleClass="modern-dialog apply-dialog"
  [header]="'Postuler ‚Äî ' + (selectedOffre?.titre || '')">

  <form #applyForm="ngForm" class="apply-form-modern" (ngSubmit)="submitApplication(applyForm)" novalidate>
    
    <!-- Badge d'information si connect√© -->
    <div *ngIf="isAuth && candidatProfile" class="auth-info-banner">
      <i class="pi pi-check-circle"></i>
      <span>Vos informations ont √©t√© pr√©-remplies automatiquement</span>
    </div>

    <!-- Section : Informations personnelles -->
    <div class="form-section">
      <h3 class="form-section-title">
        <i class="pi pi-user"></i>
        Informations personnelles
      </h3>

      <div class="form-row">
        <div class="form-field">
          <label class="form-label">Nom *</label>
          <input pInputText name="nom" [(ngModel)]="apply.nom" required [readonly]="isAuth" 
                 class="modern-input" [class.readonly-input]="isAuth" />
        </div>
        <div class="form-field">
          <label class="form-label">Pr√©nom *</label>
          <input pInputText name="prenom" [(ngModel)]="apply.prenom" required [readonly]="isAuth" 
                 class="modern-input" [class.readonly-input]="isAuth" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label class="form-label">Email *</label>
          <input pInputText type="email" name="email" [(ngModel)]="apply.email" required email [readonly]="isAuth" 
                 class="modern-input" [class.readonly-input]="isAuth" />
          <small class="form-hint" *ngIf="!isAuth">
            Vous avez d√©j√† un compte ? <a (click)="goLogin()" class="link-primary">Se connecter</a>
          </small>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label class="form-label">Ville *</label>
          <input pInputText name="ville" [(ngModel)]="apply.ville" [required]="!isAuth" 
                 autocomplete="address-level2" placeholder="Ex: Ouagadougou" [readonly]="isAuth"
                 class="modern-input" [class.readonly-input]="isAuth" #villeModel="ngModel" />
          <small class="form-error" *ngIf="!isAuth && villeModel.invalid && (villeModel.dirty || applyForm.submitted)">
            La ville est obligatoire.
          </small>
        </div>

        <div class="form-field" *ngIf="!isAuth">
          <label class="form-label">Date de naissance *</label>
          <input pInputText type="date" name="date_naissance" [(ngModel)]="apply.date_naissance" 
                 [required]="!isAuth" [attr.max]="today" class="modern-input" #dobModel="ngModel" />
          <small class="form-error" *ngIf="dobModel.invalid && (dobModel.dirty || applyForm.submitted)">
            La date de naissance est obligatoire.
          </small>
        </div>
      </div>

      <!-- Sexe (invit√© uniquement) -->
      <div class="form-row" *ngIf="!isAuth">
        <div class="form-field full-width">
          <label class="form-label">Sexe</label>
          <div class="radio-group">
            <div class="radio-item">
              <p-radioButton name="sexe" inputId="sxM" value="M" [(ngModel)]="apply.sexe"></p-radioButton>
              <label for="sxM">Homme</label>
            </div>
            <div class="radio-item">
              <p-radioButton name="sexe" inputId="sxF" value="F" [(ngModel)]="apply.sexe"></p-radioButton>
              <label for="sxF">Femme</label>
            </div>
            <div class="radio-item">
              <p-radioButton name="sexe" inputId="sxX" value="X" [(ngModel)]="apply.sexe"></p-radioButton>
              <label for="sxX">Autre</label>
            </div>
          </div>
        </div>
      </div>

      <div class="form-row" *ngIf="!isAuth">
        <div class="form-field">
          <label class="form-label">Niveau d'√©tude</label>
          <p-select name="niveau_etude" [(ngModel)]="apply.niveau_etude" [options]="niveauEtudeOptions" 
                    optionLabel="label" optionValue="value" placeholder="S√©lectionner" 
                    [style]="{ width: '100%' }" styleClass="modern-select"></p-select>
        </div>
      </div>

      <!-- Disponibilit√© (invit√© uniquement) -->
      <div class="form-row" *ngIf="!isAuth">
        <div class="form-field full-width">
          <label class="form-label">Disponibilit√©</label>
          <div class="radio-group">
            <div class="radio-item">
              <p-radioButton name="disponibilite" inputId="dispNow" value="immediate" [(ngModel)]="apply.disponibilite"></p-radioButton>
              <label for="dispNow">Imm√©diate</label>
            </div>
            <div class="radio-item">
              <p-radioButton name="disponibilite" inputId="disp1w" value="sous_1_semaine" [(ngModel)]="apply.disponibilite"></p-radioButton>
              <label for="disp1w">Sous 1 semaine</label>
            </div>
            <div class="radio-item">
              <p-radioButton name="disponibilite" inputId="disp2w" value="sous_2_semaines" [(ngModel)]="apply.disponibilite"></p-radioButton>
              <label for="disp2w">Sous 2 semaines</label>
            </div>
            <div class="radio-item">
              <p-radioButton name="disponibilite" inputId="disp1m" value="sous_1_mois" [(ngModel)]="apply.disponibilite"></p-radioButton>
              <label for="disp1m">Sous 1 mois</label>
            </div>
            <div class="radio-item">
              <p-radioButton name="disponibilite" inputId="dispOther" value="autre" [(ngModel)]="apply.disponibilite"></p-radioButton>
              <label for="dispOther">Autre</label>
            </div>
          </div>
          <input *ngIf="apply.disponibilite === 'autre'" pInputText name="disponibilite_autre" 
                 [(ngModel)]="apply.disponibilite_autre" placeholder="Ex: d√©but octobre" 
                 class="modern-input mt-2" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label class="form-label">T√©l√©phone</label>
          <input pInputText name="phone" [(ngModel)]="apply.phone" placeholder="+226 70 00 00 00" 
                 [readonly]="isAuth" class="modern-input" [class.readonly-input]="isAuth" />
        </div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <label class="form-label">Pays</label>
          <p-select name="pays" [(ngModel)]="apply.pays" [options]="paysOptions" optionLabel="label" 
                    optionValue="value" placeholder="S√©lectionner" [filter]="true" [virtualScroll]="true" 
                    [virtualScrollItemSize]="38" [style]="{ width: '100%' }" styleClass="modern-select">
            <ng-template pTemplate="selectedItem" let-opt>
              <div class="flex items-center gap-2" *ngIf="opt">
                <img *ngIf="opt.flag" [src]="opt.flag" alt="" width="20" height="14" 
                     style="border-radius: 2px; border: 1px solid #e5e7eb" />
                <span>{{ opt.label }}</span>
              </div>
              <span *ngIf="!opt" class="text-gray-400">S√©lectionner</span>
            </ng-template>
            <ng-template pTemplate="item" let-opt>
              <div class="flex items-center gap-2">
                <img *ngIf="opt.flag" [src]="opt.flag" alt="" width="20" height="14" 
                     style="border-radius: 2px; border: 1px solid #e5e7eb" />
                <span>{{ opt.label }}</span>
              </div>
            </ng-template>
          </p-select>
        </div>

        <div class="form-field">
          <label class="form-label">Ann√©es d'exp√©rience</label>
          <p-inputNumber name="experience" [(ngModel)]="apply.experience" [min]="0" [max]="60" 
                         [useGrouping]="false" [style]="{ width: '100%' }" styleClass="modern-input"></p-inputNumber>
        </div>
      </div>
    </div>

    <!-- Section : Documents -->
    <div class="form-section">
      <h3 class="form-section-title">
        <i class="pi pi-file"></i>
        Documents
      </h3>

      <div class="form-row">
        <div class="form-field full-width">
          <label class="form-label">CV *</label>
          <div class="radio-group mb-2">
            <div class="radio-item">
              <p-radioButton name="cvChoice" inputId="cvExisting" value="existing" 
                            [(ngModel)]="apply.cvChoice" [disabled]="!isAuth"></p-radioButton>
              <label for="cvExisting">Utiliser mon CV existant</label>
            </div>
            <div class="radio-item">
              <p-radioButton name="cvChoice" inputId="cvUpload" value="upload" 
                            [(ngModel)]="apply.cvChoice"></p-radioButton>
              <label for="cvUpload">T√©l√©verser un nouveau CV</label>
            </div>
          </div>
          <input *ngIf="apply.cvChoice === 'upload'" type="file" accept=".pdf,.doc,.docx" 
                 (change)="onApplyFile($event)" class="file-input-modern" />
          <small class="form-hint">PDF ou DOC, 5 Mo max.</small>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field full-width">
          <label class="form-label">Lettre de motivation</label>
          <div class="radio-group mb-2">
            <div class="radio-item">
              <p-radioButton name="lmChoice" inputId="lmText" value="text" 
                            [(ngModel)]="apply.lmChoice"></p-radioButton>
              <label for="lmText">Saisir du texte</label>
            </div>
            <div class="radio-item">
              <p-radioButton name="lmChoice" inputId="lmUpload" value="upload" 
                            [(ngModel)]="apply.lmChoice"></p-radioButton>
              <label for="lmUpload">T√©l√©verser un fichier</label>
            </div>
          </div>

          <textarea *ngIf="apply.lmChoice === 'text'" pTextarea name="motivation" 
                    [(ngModel)]="apply.motivation" rows="5" autoResize="true" 
                    placeholder="Expliquez bri√®vement pourquoi vous √™tes le candidat id√©al..." 
                    class="modern-textarea"></textarea>

          <div *ngIf="apply.lmChoice === 'upload'">
            <input type="file" accept=".pdf,.doc,.docx,.txt,.odt" (change)="onApplyLmFile($event)" 
                   class="file-input-modern" />
            <small class="form-hint">PDF, DOC, DOCX, TXT ou ODT ‚Äî 5 Mo max.</small>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-field full-width checkbox-field">
          <p-checkbox inputId="reviewNow" name="reviewNow" binary="true" 
                     [(ngModel)]="apply.reviewNow"></p-checkbox>
          <label for="reviewNow" class="checkbox-label">
            V√©rifier ma candidature avant envoi
          </label>
        </div>
      </div>
    </div>

    <!-- Footer actions -->
    <div class="form-footer">
      <button pButton type="button" label="Annuler" icon="pi pi-times" 
              class="p-button-text p-button-secondary" (click)="applyVisible=false"></button>
      <button pButton type="submit" label="Envoyer ma candidature" icon="pi pi-send" 
              class="submit-button-modern"
              [disabled]="applyForm.invalid || (!isAuth && !apply.ville.trim()) || (apply.cvChoice==='upload' && !cvFile)">
      </button>
    </div>
  </form>
</p-dialog>


<!-- ======== D√âTAIL CONSEIL ======== -->
<p-dialog
  [(visible)]="conseilDialogVisible"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [dismissableMask]="true"
  [style]="{ width: '900px', maxWidth: '95vw' }"
  [breakpoints]="{ '960px': '95vw', '640px': '100vw' }"
  styleClass="modern-dialog conseil-dialog"
  [header]="currentConseil?.titre || 'Conseil'">

  <ng-template pTemplate="content">
    <!-- Chargement -->
    <div *ngIf="loadingConseil" class="loading-state">
      <i class="pi pi-spin pi-spinner text-4xl text-blue-600"></i>
      <span class="mt-3 text-gray-600">Chargement du conseil...</span>
    </div>

    <!-- Contenu -->
    <div *ngIf="!loadingConseil && currentConseil" class="conseil-content">
      <!-- Meta informations -->
      <div class="conseil-meta">
        <p-tag *ngIf="currentConseil.categorie" [value]="currentConseil.categorie" 
               severity="success" styleClass="tag-modern"></p-tag>
        <p-tag *ngIf="currentConseil.niveau" [value]="currentConseil.niveau" 
               severity="secondary" styleClass="tag-modern"></p-tag>
        <span *ngIf="currentConseil.publie_le" class="conseil-date">
          <i class="pi pi-calendar"></i>
          {{ currentConseil.publie_le | date:'mediumDate' }}
        </span>
      </div>

      <!-- Divider -->
      <div class="dialog-divider"></div>

      <!-- Corps du conseil -->
      <div class="conseil-body-modern" [innerHTML]="conseilSafeHtml"></div>
    </div>

    <!-- √âtat vide -->
    <div *ngIf="!loadingConseil && !currentConseil" class="empty-state">
      <i class="pi pi-info-circle text-4xl text-gray-400"></i>
      <p class="mt-3 text-gray-600">Impossible d'afficher ce conseil pour le moment.</p>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <button pButton type="button" label="Fermer" icon="pi pi-times" 
            class="p-button-text p-button-secondary" (click)="conseilDialogVisible=false"></button>
    <button *ngIf="currentConseil?.id" pButton type="button" label="Ouvrir la page compl√®te" 
            icon="pi pi-external-link" class="p-button-text p-button-primary" 
            (click)="goToConseil(currentConseil.id)"></button>
  </ng-template>
</p-dialog>

<!-- Dialog r√©utilisable "Cr√©er une offre" -->
<app-offre-create-dialog #createDialog (created)="onOfferCreated($event)"></app-offre-create-dialog>

<!-- Styles am√©lior√©s -->
<style>
  /* ===== STYLES G√âN√âRAUX ===== */
  .section-container {
    padding: 3rem 1.5rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  @media (min-width: 768px) {
    .section-container { padding: 4rem 2rem; }
  }

  @media (min-width: 1024px) {
    .section-container { padding: 5rem 3rem; }
  }

  /* ===== EN-T√äTES DE SECTIONS ===== */
  .section-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .section-title {
    font-size: 2.5rem;
    font-weight: 800;
    color: #111d9d;
    margin-bottom: 1rem;
    background: linear-gradient(135deg, #111d9d 0%, #0a6c34 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  @media (min-width: 768px) {
    .section-title { font-size: 3rem; }
  }

  .section-subtitle {
    font-size: 1.125rem;
    color: #64748b;
    max-width: 600px;
    margin: 0 auto 2rem;
    line-height: 1.6;
  }

  .see-all-btn {
    color: #111d9d !important;
    border-color: #111d9d !important;
    margin-top: 1rem;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .see-all-btn:hover {
    background-color: #111d9d !important;
    color: white !important;
    transform: translateY(-2px);
  }

  /* ===== S√âPARATEURS ===== */
  .section-divider {
    height: 2px;
    background: linear-gradient(90deg, transparent 0%, #111d9d 50%, transparent 100%);
    margin: 2rem 0;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .dialog-divider {
    height: 1px;
    background: linear-gradient(90deg, transparent 0%, #e2e8f0 50%, transparent 100%);
    margin: 1.5rem 0;
  }

  /* ===== GRILLES DE CARTES ===== */
  .cards-grid {
    display: grid;
    gap: 2rem;
    grid-template-columns: 1fr;
  }

  @media (min-width: 640px) {
    .cards-grid { grid-template-columns: repeat(2, 1fr); }
  }

  .featured-grid {
    @media (min-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  }

  .recent-grid {
    @media (min-width: 1024px) { grid-template-columns: repeat(4, 1fr); }
  }

  .tips-grid {
    @media (min-width: 1024px) { grid-template-columns: repeat(3, 1fr); }
  }

  /* ===== CARTES OFFRES VEDETTES ===== */
  .featured-card {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 1rem;
    padding: 1.5rem;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  }

  .featured-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.12);
    border-color: #111d9d;
  }

  .card-ribbon {
    position: absolute;
    top: 1rem;
    right: -2rem;
    background: linear-gradient(45deg, #dc2626 0%, #b91c1c 100%);
    color: white;
    padding: 0.35rem 2.5rem;
    font-size: 0.8rem;
    font-weight: 800;
    transform: rotate(45deg);
    transform-origin: center;
    box-shadow: 0 3px 12px rgba(220, 38, 38, 0.4);
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    z-index: 10;
    border: 1px solid rgba(255, 255, 255, 0.2);
    letter-spacing: 0.5px;
  }

  /* ===== CARTES OFFRES R√âCENTES ===== */
  .job-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 0.75rem;
    padding: 1.25rem;
    transition: all 0.3s ease;
  }

  .job-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
    border-color: #0a6c34;
  }

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .job-info { flex: 1; min-width: 0; }

  .job-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: #1e293b;
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .job-meta {
    font-size: 0.875rem;
    color: #64748b;
    margin-top: 0.25rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .badges-container-vedette {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    align-items: flex-end;
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
  }

  .type-badge {
    font-size: 0.75rem;
    padding: 0.25rem 0.75rem;
    border-radius: 1rem;
    background-color: #dcfce7;
    color: #166534;
    font-weight: 500;
    white-space: nowrap;
  }

  .job-description {
    font-size: 0.875rem;
    color: var(--text-medium);
    line-height: 1.5;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    overflow: hidden;
  }

  .card-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 1rem;
  }

  .publish-date { font-size: 0.75rem; color: #9ca3af; }

  .view-btn {
    font-size: 0.75rem !important;
    padding: 0.5rem 1rem !important;
    background-color: #111d9d !important;
    border-color: #111d9d !important;
    transition: all 0.3s ease !important;
  }

  .view-btn:hover {
    background-color: #0d1784 !important;
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 12px rgba(17, 29, 157, 0.3) !important;
  }

  /* ===== CARROUSEL PARTENAIRES ===== */
  .carousel-container { margin: 2rem 0; }

  .partner-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 0.75rem;
    overflow: hidden;
    margin: 0 0.75rem;
    transition: all 0.3s ease;
  }

  .partner-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
  }

  .partner-media {
    position: relative;
    width: 100%;
    padding-top: 45%;
    background: #f8fafc;
  }

  .partner-media img, .partner-media video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .partner-content { padding: 1rem; }

  .partner-title {
    font-size: 0.95rem;
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 0.5rem;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .partner-description {
  font-size: 0.8rem;
  color: #64748b;
  line-height: 1.4;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  overflow: hidden;
  margin-bottom: 0.75rem;
  line-clamp: 2; /* Standard property for compatibility */
}

  .partner-link {
    color: #0a6c34 !important;
    font-size: 0.8rem;
    font-weight: 600;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    transition: color 0.3s ease;
  }

  .partner-link:hover { color: #166534 !important; }

  /* ===== CARTES CONSEILS ===== */
  .tip-card {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 0.75rem;
    padding: 1.25rem;
    transition: all 0.3s ease;
  }

  .tip-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.08);
    border-color: #ff7104;
  }

  .tip-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .tip-title {
    font-size: 1rem;
    font-weight: 600;
    color: #1e293b;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2; /* Standard property for compatibility */
    overflow: hidden;
}

.tip-excerpt {
    font-size: 0.875rem;
    color: #4b5563;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
    line-clamp: 3; /* Standard property for compatibility */
    overflow: hidden;
    margin-bottom: 1rem;
}

  .tip-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .tip-meta {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .tip-date { font-size: 0.75rem; color: #9ca3af; }

  .read-btn {
    font-size: 0.75rem !important;
    padding: 0.5rem 1rem !important;
    background-color: #ff7104 !important;
    border-color: #ff7104 !important;
  }

  .read-btn:hover {
    background-color: #ea580c !important;
    transform: translateY(-2px) !important;
  }

  /* ===== STYLES DIALOG MODERNIS√âS ===== */
  :host ::ng-deep .modern-dialog .p-dialog-header {
    background: #111d9d;
    color: white;
    padding: 1.5rem 2rem;
    border-bottom: none;
    border-radius: 0.75rem 0.75rem 0 0;
  }

  :host ::ng-deep .modern-dialog .p-dialog-header .p-dialog-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: white;
  }

  :host ::ng-deep .modern-dialog .p-dialog-header .p-dialog-header-icons button {
    color: white !important;
    width: 2.5rem;
    height: 2.5rem;
  }

  :host ::ng-deep .modern-dialog .p-dialog-header .p-dialog-header-icons button:hover {
    background: rgba(255, 255, 255, 0.1) !important;
  }

  :host ::ng-deep .modern-dialog .p-dialog-content {
    padding: 2rem;
    background: #ffffff;
  }

  :host ::ng-deep .modern-dialog .p-dialog-footer {
    padding: 1.5rem 2rem;
    background: #f8fafc;
    border-top: 1px solid #e2e8f0;
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
  }

  /* Dialog D√©tails Offre */
  .offer-details-container { display: flex; flex-direction: column; gap: 1.5rem; }

  .offer-header-section {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    padding: 1.5rem;
    border-radius: 0.75rem;
    border: 1px solid #bae6fd;
  }

  .offer-company-info {
    display: flex;
    align-items: center;
  }

  .offer-tags-section {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }

  .tag-modern {
    font-weight: 600 !important;
    padding: 0.5rem 1rem !important;
    border-radius: 1rem !important;
    font-size: 0.875rem !important;
  }

  .section-subtitle-dialog {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.125rem;
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 1rem;
  }

  .offer-html-content {
    font-size: 0.95rem;
    line-height: 1.8;
    color: #374151;
  }

  .offer-html-content p { margin: 0.75rem 0; }
  .offer-html-content ul, .offer-html-content ol { margin: 0.75rem 0 0.75rem 1.5rem; }
  .offer-html-content li { margin: 0.5rem 0; }
  .offer-html-content h1, .offer-html-content h2, .offer-html-content h3 {
    margin: 1.5rem 0 0.75rem;
    font-weight: 600;
    color: #111827;
  }

  .offer-footer-section {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    padding-top: 1.5rem;
    border-top: 1px solid #e2e8f0;
  }

  .apply-button-modern {
    background: #111d9d !important;
    border: none !important;
    padding: 0.875rem 2rem !important;
    font-weight: 700 !important;
    font-size: 0.9375rem !important;
    letter-spacing: 0.01em !important;
    border-radius: 0.625rem !important;
    box-shadow: 0 4px 12px rgba(17, 29, 157, 0.25) !important;
    transition: all 0.3s ease !important;
    color: #ffffff !important;
  }

  .apply-button-modern:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 20px rgba(17, 29, 157, 0.4) !important;
  }

  /* Dialog Postuler */
  .apply-form-modern {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .auth-info-banner {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background: linear-gradient(135deg, #dcfce7 0%, #d1fae5 100%);
    color: #166534;
    padding: 1rem 1.5rem;
    border-radius: 0.75rem;
    border: 1px solid #86efac;
    font-weight: 500;
    font-size: 0.95rem;
  }

  .auth-info-banner i {
    font-size: 1.25rem;
  }

  .form-section {
    background: #f8fafc;
    padding: 1.5rem;
    border-radius: 0.75rem;
    border: 1px solid #e2e8f0;
  }

  .form-section-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.125rem;
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 1.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 2px solid #e2e8f0;
  }

  .form-row {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.25rem;
  }

  .form-field {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .form-field.full-width {
    flex: 1 1 100%;
  }

  .form-label {
    font-weight: 600;
    color: #374151;
    font-size: 0.9rem;
  }

  .modern-input, .modern-textarea {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid #e2e8f0;
    border-radius: 0.5rem;
    font-size: 0.95rem;
    transition: all 0.3s ease;
  }

  .modern-input:focus, .modern-textarea:focus {
    border-color: #111d9d;
    box-shadow: 0 0 0 3px rgba(17, 29, 157, 0.1);
    outline: none;
  }

  .readonly-input {
    background: #f3f4f6;
    cursor: not-allowed;
    opacity: 0.7;
  }

  .form-hint {
    color: #6b7280;
    font-size: 0.85rem;
    margin-top: 0.25rem;
  }

  .form-error {
    color: #dc2626;
    font-size: 0.85rem;
    margin-top: 0.25rem;
    font-weight: 500;
  }

  .link-primary {
    color: #111d9d;
    font-weight: 600;
    cursor: pointer;
    text-decoration: underline;
  }

  .link-primary:hover {
    color: #0a6c34;
  }

  .radio-group {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .radio-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .radio-item label {
    cursor: pointer;
    font-size: 0.95rem;
    color: #374151;
  }

  .checkbox-field {
    display: flex;
    flex-direction: row !important;
    align-items: center;
    gap: 0.75rem;
  }

  .checkbox-label {
    font-size: 0.95rem;
    color: #374151;
    cursor: pointer;
  }

  .file-input-modern {
    padding: 0.5rem;
    border: 2px dashed #e2e8f0;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .file-input-modern:hover {
    border-color: #111d9d;
    background: #f8fafc;
  }

  .form-footer {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    padding-top: 1.5rem;
    border-top: 2px solid #e2e8f0;
  }

  .submit-button-modern {
    background: linear-gradient(135deg, #111d9d 0%, #0a6c34 100%) !important;
    border: none !important;
    padding: 0.75rem 2rem !important;
    font-weight: 600 !important;
    font-size: 1rem !important;
    box-shadow: 0 4px 12px rgba(17, 29, 157, 0.3) !important;
    transition: all 0.3s ease !important;
  }

  .submit-button-modern:not([disabled]):hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 6px 20px rgba(17, 29, 157, 0.4) !important;
  }

  .submit-button-modern[disabled] {
    opacity: 0.5;
    cursor: not-allowed;
  }

  /* Dialog Conseil */
  .loading-state, .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 3rem;
    text-align: center;
  }

  .conseil-content { display: flex; flex-direction: column; gap: 1.5rem; }

  .conseil-meta {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.75rem;
  }

  .conseil-date {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: #6b7280;
  }

  .conseil-body-modern {
    font-size: 1rem;
    line-height: 1.8;
    color: #374151;
    max-height: 60vh;
    overflow-y: auto;
    padding-right: 1rem;
  }

  .conseil-body-modern::-webkit-scrollbar {
    width: 8px;
  }

  .conseil-body-modern::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 4px;
  }

  .conseil-body-modern::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 4px;
  }

  .conseil-body-modern::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
  }

  .conseil-body-modern p { margin: 1rem 0; }
  .conseil-body-modern ul, .conseil-body-modern ol { margin: 1rem 0 1rem 1.5rem; }
  .conseil-body-modern li { margin: 0.5rem 0; }
  .conseil-body-modern h1, .conseil-body-modern h2, .conseil-body-modern h3 {
    margin: 2rem 0 1rem;
    font-weight: 600;
    color: #111827;
  }
  .conseil-body-modern h1 { font-size: 1.5rem; }
  .conseil-body-modern h2 { font-size: 1.25rem; }
  .conseil-body-modern h3 { font-size: 1.1rem; }

  /* ===== CAROUSEL CUSTOMIZATION ===== */
  :host ::ng-deep .p-carousel .p-carousel-prev,
  :host ::ng-deep .p-carousel .p-carousel-next {
    background-color: #111d9d;
    color: white;
    border: none;
    width: 3rem;
    height: 3rem;
    margin: 0.5rem;
  }

  :host ::ng-deep .p-carousel .p-carousel-prev:hover,
  :host ::ng-deep .p-carousel .p-carousel-next:hover {
    background-color: #0d1784;
  }

  /* ===== ANIMATIONS ===== */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .section-container { animation: fadeInUp 0.6s ease-out; }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 768px) {
    .form-row { flex-direction: column; }
    .radio-group { flex-direction: column; }
  }

  /* ================== FIX DIALOG (D√âBORDEMENT & TEXTE COUP√â) ================== */
/* 1) Le dialog ne d√©passe jamais le viewport */
:host ::ng-deep .elegant-dialog {
  width: min(900px, 95vw) !important;
  max-width: 95vw !important;
  box-sizing: border-box;
}

/* 2) Zone de contenu : scroll vertical OK, jamais de scroll horizontal */
:host ::ng-deep .elegant-dialog .p-dialog-content {
  max-height: 78vh !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  padding-right: 1.25rem;     /* √©vite la mini-barre horizontale */
  box-sizing: border-box;
}

/* 3) Emp√™che tout l√©ger d√©bordement global pendant l'ouverture du dialog */
html, body { overflow-x: hidden; }

/* 4) Les conteneurs flex √† l'int√©rieur ne doivent pas forcer la largeur */
.offer-details-wrapper,
.offer-company-section,
.offer-description-wrapper { min-width: 0; }
.offer-company-section > *,
.offer-description-wrapper > * { min-width: 0; }

/* 5) R√®gles de WRAP propres pour **tout** le HTML inject√© */
.offer-content-html,
.offer-content-html * {
  white-space: normal !important;     /* pas de ligne infinie */
  overflow-wrap: break-word !important; /* casse au besoin (propre) */
  word-break: normal !important;      /* √©vite les coupures agressives */
  hyphens: auto !important;           /* c√©sure FR si possible (lang="fr") */
  -webkit-hyphens: auto !important;
}

/* 6) Liens/tokens tr√®s longs et <pre>/<code> qui d√©bordent parfois */
.offer-content-html a { word-break: break-all !important; }
.offer-content-html pre,
.offer-content-html code,
.offer-content-html kbd,
.offer-content-html samp {
  white-space: pre-wrap !important;
  word-break: break-word !important;
}

/* 7) M√©dias & tableaux ne d√©passent jamais la largeur utile */
.offer-content-html img,
.offer-content-html video,
.offer-content-html iframe,
.offer-content-html table {
  max-width: 100% !important;
  height: auto !important;
}
.offer-content-html table {
  display: block !important;          /* autorise le wrap + scroll X interne si tr√®s large */
  overflow-x: auto !important;
  border-collapse: collapse;
}
.offer-content-html th,
.offer-content-html td {
  border: 1px solid #e2e8f0;
  padding: .5rem .75rem;
}

/* 8) Titre du dialog : une seule ligne + ellipsis propre */
:host ::ng-deep .elegant-dialog .p-dialog-title {
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: calc(100vw - 8rem);
}
/* ================== FIX D√âBORDEMENT (version modern-dialog) ================== */

/* 1) Tous les dialogs "modern" restent dans le viewport */
:host ::ng-deep .modern-dialog {
  width: min(900px, 95vw) !important;
  max-width: 95vw !important;
  box-sizing: border-box;
}
:host ::ng-deep .modern-dialog.apply-dialog {
  width: min(800px, 95vw) !important;
}

/* 2) Zone de contenu : scroll vertical uniquement, jamais horizontal */
:host ::ng-deep .modern-dialog .p-dialog-content {
  max-height: 78vh !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
  padding-right: 1.25rem; /* √©vite la mini barre horizontale */
  box-sizing: border-box;
}

/* 3) Emp√™che tout l√©ger d√©bordement global */
html, body { overflow-x: hidden; }

/* 4) Les conteneurs flex internes ne doivent pas forcer la largeur */
.offer-details-container,
.offer-header-section,
.offer-description-section,
.offer-footer-section { min-width: 0; }
.offer-header-section > *,
.offer-description-section > *,
.offer-footer-section > * { min-width: 0; }

/* 5) WRAP propre pour TOUT le HTML inject√© (dialog Offres) */
.offer-html-content,
.offer-html-content * {
  white-space: normal !important;
  overflow-wrap: break-word !important;
  word-break: normal !important;     /* pas de coupures agressives */
  hyphens: auto !important;          /* c√©sure FR si possible */
  -webkit-hyphens: auto !important;
}

/* 6) Liens/tokens tr√®s longs & blocs code */
.offer-html-content a { word-break: break-all !important; }
.offer-html-content pre,
.offer-html-content code,
.offer-html-content kbd,
.offer-html-content samp {
  white-space: pre-wrap !important;
  word-break: break-word !important;
}

/* 7) M√©dias & tableaux : jamais plus larges que le dialog */
.offer-html-content img,
.offer-html-content video,
.offer-html-content iframe,
.offer-html-content table {
  max-width: 100% !important;
  height: auto !important;
}
.offer-html-content table {
  display: block !important;      /* permet scroll X interne si besoin */
  overflow-x: auto !important;
  border-collapse: collapse;
}
.offer-html-content th,
.offer-html-content td {
  border: 1px solid #e2e8f0;
  padding: .5rem .75rem;
}

/* 8) Corps de conseil (m√™mes protections) */
.conseil-body-modern,
.conseil-body-modern * {
  white-space: normal !important;
  overflow-wrap: break-word !important;
  word-break: normal !important;
  hyphens: auto !important;
  -webkit-hyphens: auto !important;
}
.conseil-body-modern pre,
.conseil-body-modern code {
  white-space: pre-wrap !important;
  word-break: break-word !important;
}
.conseil-body-modern img,
.conseil-body-modern video,
.conseil-body-modern iframe,
.conseil-body-modern table {
  max-width: 100% !important;
  height: auto !important;
}
.conseil-body-modern table {
  display: block !important;
  overflow-x: auto !important;
}

/* 9) Titre des dialogs : ellipsis sur une ligne */
:host ::ng-deep .modern-dialog .p-dialog-title {
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: calc(100vw - 8rem);
}


</style>

<!-- Footer -->
<app-footer-widget></app-footer-widget>